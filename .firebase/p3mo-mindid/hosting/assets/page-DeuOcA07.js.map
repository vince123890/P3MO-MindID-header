{"version":3,"file":"page-DeuOcA07.js","sources":["../../src/app/(protected)/projects/[id]/risks/create/page.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router\";\nimport { Page } from \"admiral\";\nimport { Modal, message, Form } from \"antd\";\n\nimport { RiskForm } from \"@/app/(protected)/projects/_components/risk-form.jsx\";\nimport { projectRisks } from \"@/app/(protected)/projects/_data/risks.js\";\n\nexport const Component = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n\n  const breadcrumbs = [\n    {\n      label: \"Projects\",\n      path: \"/projects\",\n    },\n    {\n      label: \"Project Detail\",\n      path: `/projects/${id}`,\n    },\n    {\n      label: \"Risks\",\n      path: `/projects/${id}/risks`,\n    },\n    {\n      label: \"Create Risk\",\n      path: `/projects/${id}/risks/create`,\n    },\n  ];\n\n  const handleFinish = (values) => {\n    setLoading(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      try {\n        // Generate new risk ID\n        const newId = String(Math.max(...projectRisks.data.items.map(item => parseInt(item.id)), 0) + 1);\n        \n        // Generate risk number - get the highest number for this project and increment\n        const projectRisksFiltered = projectRisks.data.items\n          .filter(item => item.project_id === id)\n          .map(item => {\n            const match = item.nomor_resiko.match(/RSK-(\\d+)/);\n            return match ? parseInt(match[1]) : 0;\n          });\n        \n        const lastRiskNumber = projectRisksFiltered.length > 0 ? Math.max(...projectRisksFiltered) : 0;\n        const riskNumber = `RSK-${String(lastRiskNumber + 1).padStart(3, '0')}`;\n        \n        // Create new risk object\n        const newRisk = {\n          id: newId,\n          project_id: id,\n          nomor_resiko: riskNumber,\n          ...values,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n        };\n        \n        // Add to risks array (in real app, this would be an API call)\n        projectRisks.data.items.push(newRisk);\n        \n        message.success(\"Risk created successfully\");\n        navigate(`/projects/${id}?tab=risks`);\n      } catch (error) {\n        message.error(\"Failed to create risk\");\n      } finally {\n        setLoading(false);\n      }\n    }, 1000);\n  };\n\n  return (\n    <Page\n      title=\"Create Risk\"\n      breadcrumbs={breadcrumbs}\n    >\n      <Modal\n        title=\"Create New Risk\"\n        open={true}\n        onCancel={() => navigate(`/projects/${id}?tab=risks`)}\n        footer={null}\n        width={1200}\n        centered\n        styles={{\n          body: {\n            maxHeight: '80vh',\n            overflowY: 'auto'\n          }\n        }}\n      >\n        <RiskForm\n          formProps={{\n            form,\n            onFinish: handleFinish,\n          }}\n          loading={loading}\n          onSubmit={handleFinish}\n        />\n      </Modal>\n    </Page>\n  );\n};\n\nexport default Component;\n"],"names":["Component","id","useParams","navigate","useNavigate","form","Form","loading","setLoading","useState","breadcrumbs","handleFinish","values","newId","projectRisks","item","projectRisksFiltered","match","lastRiskNumber","riskNumber","newRisk","message","jsx","Page","Modal","RiskForm"],"mappings":"gzCAQO,MAAMA,EAAY,IAAM,CAC7B,KAAM,CAAE,GAAAC,CAAA,EAAOC,EAAA,EACTC,EAAWC,EAAA,EACX,CAACC,CAAI,EAAIC,EAAK,QAAA,EACd,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EAEtCC,EAAc,CAClB,CACE,MAAO,WACP,KAAM,WAAA,EAER,CACE,MAAO,iBACP,KAAM,aAAaT,CAAE,EAAA,EAEvB,CACE,MAAO,QACP,KAAM,aAAaA,CAAE,QAAA,EAEvB,CACE,MAAO,cACP,KAAM,aAAaA,CAAE,eAAA,CACvB,EAGIU,EAAgBC,GAAW,CAC/BJ,EAAW,EAAI,EAGf,WAAW,IAAM,CACf,GAAI,CAEF,MAAMK,EAAQ,OAAO,KAAK,IAAI,GAAGC,EAAa,KAAK,MAAM,IAAIC,GAAQ,SAASA,EAAK,EAAE,CAAC,EAAG,CAAC,EAAI,CAAC,EAGzFC,EAAuBF,EAAa,KAAK,MAC5C,OAAOC,GAAQA,EAAK,aAAed,CAAE,EACrC,IAAIc,GAAQ,CACX,MAAME,EAAQF,EAAK,aAAa,MAAM,WAAW,EACjD,OAAOE,EAAQ,SAASA,EAAM,CAAC,CAAC,EAAI,CACtC,CAAC,EAEGC,EAAiBF,EAAqB,OAAS,EAAI,KAAK,IAAI,GAAGA,CAAoB,EAAI,EACvFG,EAAa,OAAO,OAAOD,EAAiB,CAAC,EAAE,SAAS,EAAG,GAAG,CAAC,GAG/DE,EAAU,CACd,GAAIP,EACJ,WAAYZ,EACZ,aAAckB,EACd,GAAGP,EACH,WAAY,IAAI,KAAA,EAAO,YAAA,EACvB,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAIrCE,EAAa,KAAK,MAAM,KAAKM,CAAO,EAEpCC,EAAQ,QAAQ,2BAA2B,EAC3ClB,EAAS,aAAaF,CAAE,YAAY,CACtC,MAAgB,CACdoB,EAAQ,MAAM,uBAAuB,CACvC,QAAA,CACEb,EAAW,EAAK,CAClB,CACF,EAAG,GAAI,CACT,EAEA,OACEc,EAAAA,IAACC,EAAA,CACC,MAAM,cACN,YAAAb,EAEA,SAAAY,EAAAA,IAACE,EAAA,CACC,MAAM,kBACN,KAAM,GACN,SAAU,IAAMrB,EAAS,aAAaF,CAAE,YAAY,EACpD,OAAQ,KACR,MAAO,KACP,SAAQ,GACR,OAAQ,CACN,KAAM,CACJ,UAAW,OACX,UAAW,MAAA,CACb,EAGF,SAAAqB,EAAAA,IAACG,EAAA,CACC,UAAW,CACT,KAAApB,EACA,SAAUM,CAAA,EAEZ,QAAAJ,EACA,SAAUI,CAAA,CAAA,CACZ,CAAA,CACF,CAAA,CAGN"}