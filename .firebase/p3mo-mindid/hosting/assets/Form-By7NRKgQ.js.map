{"version":3,"file":"Form-By7NRKgQ.js","sources":["../../src/app/(protected)/messaging/_components/Form.jsx"],"sourcesContent":["import { Button, Col, Form, Input, Row, Select, Space, Typography, Tabs } from \"antd\";\nimport { Section } from \"admiral\";\nimport { Flex } from \"antd\";\nimport { useNavigate } from \"react-router\";\nimport { useState } from \"react\";\nimport { EyeOutlined, EditOutlined } from \"@ant-design/icons\";\n\nimport { useFormErrorHandling } from \"@/app/_hooks/form/use-form-error-handling\";\nimport { listUsers } from \"../../user-management/_data\";\nimport { allTemplateMessagings } from \"../../master-data/template-messaging/_data\";\n\nconst { TextArea } = Input;\n\nexport const FormMessaging = ({ formProps, error, loading, isEdit }) => {\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [bodyContent, setBodyContent] = useState(\"\");\n  const [activePreviewTab, setActivePreviewTab] = useState(\"edit\");\n\n  useFormErrorHandling(error, ({ key, message }) =>\n    form.setFields([{ name: key, errors: [message] }]),\n  );\n\n  // Get user options for To and CC fields\n  const userOptions = listUsers.data.items\n    .filter(user => user.status === \"Active\")\n    .map((user) => ({\n      label: user.nama_user,\n      value: user.nama_user,\n    }));\n\n  // Get template options\n  const templateOptions = allTemplateMessagings.data.items\n    .filter(template => template.status === \"Active\")\n    .map((template) => ({\n      label: template.nama_template,\n      value: template.id,\n      body: template.body,\n    }));\n\n  // Handle template selection\n  const handleTemplateSelect = (templateId) => {\n    if (templateId) {\n      const selectedTemplate = allTemplateMessagings.data.items.find(\n        template => template.id === templateId\n      );\n      if (selectedTemplate) {\n        form.setFieldsValue({\n          body: selectedTemplate.body\n        });\n        setBodyContent(selectedTemplate.body);\n        setSelectedTemplate(selectedTemplate);\n      }\n    } else {\n      setSelectedTemplate(null);\n    }\n  };\n\n  // Handle body content changes\n  const handleBodyChange = (e) => {\n    const value = e.target.value;\n    setBodyContent(value);\n    form.setFieldsValue({ body: value });\n  };\n\n  // Process placeholders for preview\n  const processPlaceholders = (content) => {\n    if (!content) return '<p style=\"color: #999;\">No content available</p>';\n    \n    const sampleData = {\n      '[Name]': 'John Doe',\n      '[Date]': new Date().toLocaleDateString(),\n      '[Project Name]': 'Sample Project',\n      '[Status]': 'Active',\n      '[Contact]': 'contact@example.com'\n    };\n\n    let processedContent = content;\n    Object.keys(sampleData).forEach(placeholder => {\n      const regex = new RegExp(placeholder.replace(/\\[|\\]/g, '\\\\$&'), 'g');\n      processedContent = processedContent.replace(regex, sampleData[placeholder]);\n    });\n\n    return processedContent;\n  };\n\n  const previewTabs = [\n    {\n      key: 'edit',\n      label: (\n        <span>\n          <EditOutlined />\n          Edit Content\n        </span>\n      ),\n      children: (\n        <TextArea\n          value={bodyContent}\n          onChange={handleBodyChange}\n          rows={12}\n          placeholder=\"Enter message body content (HTML supported)&#10;&#10;Available placeholders:&#10;- [Name] - Recipient name&#10;- [Date] - Current date&#10;- [Project Name] - Project name&#10;- [Status] - Status value&#10;- [Contact] - Contact information&#10;&#10;You can also select a template above to load pre-formatted content.&#10;&#10;Example:&#10;&lt;h2&gt;Message Title&lt;/h2&gt;&#10;&lt;p&gt;Hello &lt;strong&gt;[Name]&lt;/strong&gt;,&lt;/p&gt;&#10;&lt;p&gt;Your message content here...&lt;/p&gt;\"\n          style={{ fontFamily: \"monospace\" }}\n        />\n      )\n    },\n    {\n      key: 'preview',\n      label: (\n        <span>\n          <EyeOutlined />\n          HTML Preview\n        </span>\n      ),\n      children: (\n        <div style={{ \n          border: '1px solid #d9d9d9', \n          borderRadius: '6px', \n          padding: '16px',\n          backgroundColor: '#fafafa',\n          minHeight: '300px'\n        }}>\n          <Typography.Text type=\"secondary\" style={{ fontSize: '12px', display: 'block', marginBottom: '8px' }}>\n            HTML Preview (with sample placeholder values):\n          </Typography.Text>\n          <div \n            style={{ \n              backgroundColor: 'white', \n              padding: '16px', \n              borderRadius: '4px',\n              border: '1px solid #e8e8e8',\n              minHeight: '150px'\n            }}\n            dangerouslySetInnerHTML={{ \n              __html: processPlaceholders(bodyContent)\n            }}\n          />\n          \n          <Typography.Text type=\"secondary\" style={{ fontSize: '12px', display: 'block', marginTop: '16px', marginBottom: '8px' }}>\n            Raw HTML Code:\n          </Typography.Text>\n          <div style={{ \n            backgroundColor: '#f5f5f5', \n            padding: '12px', \n            borderRadius: '4px',\n            fontFamily: 'monospace',\n            fontSize: '12px',\n            whiteSpace: 'pre-wrap',\n            wordBreak: 'break-all',\n            maxHeight: '150px',\n            overflow: 'auto',\n            border: '1px solid #e8e8e8'\n          }}>\n            {bodyContent || 'No content available'}\n          </div>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <Form {...formProps} form={form} layout=\"vertical\">\n      <Section>\n        <Space direction=\"vertical\" size=\"middle\" style={{ width: \"100%\" }}>\n          <Section title=\"Message Recipients\">\n          <Row gutter={16}>\n            <Col span={12}>\n              <Form.Item\n                label=\"To\"\n                name=\"to\"\n                rules={[\n                  {\n                    required: true,\n                    message: \"At least one recipient is required\",\n                  },\n                ]}\n              >\n                <Select \n                  mode=\"multiple\"\n                  placeholder=\"Select recipients\"\n                  showSearch\n                  filterOption={(input, option) =>\n                    option.label.toLowerCase().includes(input.toLowerCase())\n                  }\n                >\n                  {userOptions.map((option) => (\n                    <Select.Option key={option.value} value={option.value}>\n                      {option.label}\n                    </Select.Option>\n                  ))}\n                </Select>\n              </Form.Item>\n            </Col>\n            <Col span={12}>\n              <Form.Item\n                label=\"CC\"\n                name=\"cc\"\n              >\n                <Select \n                  mode=\"multiple\"\n                  placeholder=\"Select CC recipients (optional)\"\n                  showSearch\n                  filterOption={(input, option) =>\n                    option.label.toLowerCase().includes(input.toLowerCase())\n                  }\n                >\n                  {userOptions.map((option) => (\n                    <Select.Option key={option.value} value={option.value}>\n                      {option.label}\n                    </Select.Option>\n                  ))}\n                </Select>\n              </Form.Item>\n            </Col>\n            <Col span={12}>\n              <Form.Item\n                label=\"Via\"\n                name=\"via\"\n                rules={[\n                  {\n                    required: true,\n                    message: \"Delivery method is required\",\n                  },\n                ]}\n              >\n                <Select placeholder=\"Select delivery method\">\n                  <Select.Option value=\"Apps\">Apps</Select.Option>\n                  <Select.Option value=\"Email\">Email</Select.Option>\n                  <Select.Option value=\"Keduanya\">Keduanya</Select.Option>\n                </Select>\n              </Form.Item>\n            </Col>\n          </Row>\n        </Section>\n\n        <Section title=\"Message Content\">\n          <Row gutter={16}>\n            <Col span={24}>\n              <Form.Item\n                label=\"Subject\"\n                name=\"subject\"\n                rules={[\n                  {\n                    required: true,\n                    message: \"Subject is required\",\n                  },\n                  {\n                    min: 5,\n                    message: \"Subject must be at least 5 characters\",\n                  },\n                ]}\n              >\n                <TextArea \n                  rows={2}\n                  placeholder=\"Enter message subject\"\n                />\n              </Form.Item>\n            </Col>\n            <Col span={24}>\n              <Form.Item\n                label=\"Add Template (Optional)\"\n                name=\"template_id\"\n              >\n                <Select \n                  placeholder=\"Select template to load content\"\n                  allowClear\n                  onChange={handleTemplateSelect}\n                >\n                  {templateOptions.map((option) => (\n                    <Select.Option key={option.value} value={option.value}>\n                      {option.label}\n                    </Select.Option>\n                  ))}\n                </Select>\n              </Form.Item>\n            </Col>\n            <Col span={24}>\n              <Form.Item\n                label=\"Body\"\n                name=\"body\"\n                rules={[\n                  {\n                    required: true,\n                    message: \"Message body is required\",\n                  },\n                  {\n                    min: 10,\n                    message: \"Message body must be at least 10 characters\",\n                  },\n                ]}\n              >\n                <Tabs\n                  activeKey={activePreviewTab}\n                  onChange={setActivePreviewTab}\n                  items={previewTabs}\n                  size=\"small\"\n                />\n              </Form.Item>\n              <div style={{ marginTop: 8, fontSize: \"12px\", color: \"#666\" }}>\n                <strong>Note:</strong> This field supports HTML formatting. Use placeholders like [Name], [Date], [Project Name] for dynamic content.\n                <br />\n                <strong>Template Integration:</strong> Select a template above to automatically load pre-formatted content.\n                <br />\n                <strong>Preview:</strong> Switch to the \"HTML Preview\" tab to see how your content will look when rendered.\n                <br />\n                <strong>Future Enhancement:</strong> This will be replaced with a TinyMCE WYSIWYG editor for better content editing experience.\n              </div>\n            </Col>\n          </Row>\n        </Section>\n        </Space>\n      </Section>\n\n      <Flex justify=\"flex-end\" gap={16} style={{ marginTop: 24 }}>\n        <Button type=\"text\" disabled={loading} onClick={() => navigate(\"/messaging\")}>\n          Cancel\n        </Button>\n        <Button type=\"primary\" htmlType=\"submit\" loading={loading}>\n          {isEdit ? \"Update Message\" : \"Send Message\"}\n        </Button>\n      </Flex>\n    </Form>\n  );\n};\n"],"names":["TextArea","Input","FormMessaging","formProps","error","loading","isEdit","form","Form","navigate","useNavigate","selectedTemplate","setSelectedTemplate","useState","bodyContent","setBodyContent","activePreviewTab","setActivePreviewTab","useFormErrorHandling","key","message","userOptions","listUsers","user","templateOptions","allTemplateMessagings","template","handleTemplateSelect","templateId","handleBodyChange","e","value","processPlaceholders","content","sampleData","processedContent","placeholder","regex","previewTabs","jsx","EditOutlined","EyeOutlined","jsxs","Typography","Section","Space","Row","Col","Select","input","option","Tabs","Flex","Button"],"mappings":"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"}