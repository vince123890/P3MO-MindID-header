import{u as P,a as A,j as e}from"./@react-router-BOJM2k20.js";import{d as t,S,R as h,C as r,a as x,F as k}from"./index-BafWvN44.js";import{S as f}from"./index-BGD_4JXV.js";import{u as O}from"./use-form-error-handling-Dj-OCOIU.js";import{F as d}from"./index-DDk6ch2l.js";import{S as p}from"./index-HUJMorX5.js";import{I as u}from"./index-BpdQMdSc.js";import{T as c}from"./index-QOKA2q-x.js";import{B as m}from"./index-BHxSUtD9.js";import{R as w}from"./PlusOutlined-Dx_yv4bP.js";import{R as W}from"./DeleteOutlined-DO7ccZ5J.js";import{s as H}from"./index-Cskjed0c.js";try{let n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},g=new n.Error().stack;g&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[g]="b0ba12b7-0692-43e7-a385-f57f040af149",n._sentryDebugIdIdentifier="sentry-dbid-b0ba12b7-0692-43e7-a385-f57f040af149")}catch{}const V=({formProps:n,error:g,loading:I,isEdit:j=!1,isView:a=!1,initialData:l=null,onSubmit:b})=>{const[v]=d.useForm(),_=P(),[o,y]=A.useState(()=>a&&(l!=null&&l.resolution_entries)?l.resolution_entries:j?[{id:1},{id:2},{id:3}]:[{id:1}]);O(g,({key:s,message:i})=>v.setFields([{name:s,errors:[i]}]));const C=[{label:"1.1.1",value:"1.1.1"},{label:"1.1.2",value:"1.1.2"},{label:"1.2.1",value:"1.2.1"},{label:"1.2.2",value:"1.2.2"},{label:"1.2.3",value:"1.2.3"},{label:"1.3.1",value:"1.3.1"},{label:"1.3.2",value:"1.3.2"},{label:"1.3.3",value:"1.3.3"},{label:"1.3.4",value:"1.3.4"},{label:"1.3.5",value:"1.3.5"},{label:"2.1.1",value:"2.1.1"},{label:"2.1.2",value:"2.1.2"},{label:"2.1.3",value:"2.1.3"},{label:"2.2.1",value:"2.2.1"},{label:"2.2.2",value:"2.2.2"},{label:"3.1.1",value:"3.1.1"},{label:"3.1.2",value:"3.1.2"},{label:"3.2.1",value:"3.2.1"},{label:"3.2.2",value:"3.2.2"},{label:"3.3.1",value:"3.3.1"},{label:"3.3.2",value:"3.3.2"}],T=[{label:"Technical",value:"Technical"},{label:"Logistical",value:"Logistical"},{label:"Environmental",value:"Environmental"},{label:"Resource",value:"Resource"},{label:"Safety",value:"Safety"},{label:"Financial",value:"Financial"},{label:"Regulatory",value:"Regulatory"}],q=[{label:"Open",value:"Open"},{label:"In Progress",value:"In Progress"},{label:"Resolved",value:"Resolved"},{label:"Closed",value:"Closed"},{label:"On Hold",value:"On Hold"}],B=[{label:"John Doe",value:"John Doe"},{label:"Jane Smith",value:"Jane Smith"},{label:"Mike Johnson",value:"Mike Johnson"},{label:"Alice Brown",value:"Alice Brown"},{label:"Bob Wilson",value:"Bob Wilson"},{label:"Carol Davis",value:"Carol Davis"},{label:"David Miller",value:"David Miller"},{label:"Eva White",value:"Eva White"}],R=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],$=[{label:"Design Conflict",value:"Design Conflict"},{label:"Supplier Delay",value:"Supplier Delay"},{label:"Regulatory Compliance",value:"Regulatory Compliance"},{label:"Manpower Shortage",value:"Manpower Shortage"},{label:"Training Delay",value:"Training Delay"},{label:"Budget Issue",value:"Budget Issue"},{label:"Quality Issue",value:"Quality Issue"},{label:"Schedule Delay",value:"Schedule Delay"}],E=s=>{b?b(s):(H.success(j?"Issue updated successfully":"Issue created successfully"),_(-1))},F=s=>({"1.1.1":"Site Preparation and Ground Clearing","1.1.2":"Site Survey and Measurement","1.2.1":"Equipment Specification","1.2.2":"Vendor Evaluation","1.2.3":"Equipment Procurement and Delivery","1.3.1":"Safety Plan Development","1.3.2":"Safety Training Program","1.3.3":"Safety Equipment Procurement","1.3.4":"Safety Certification","1.3.5":"Safety Training and Certification","2.1.1":"Soil Testing and Analysis","2.1.2":"Foundation Work","2.1.3":"Structural Framework","2.2.1":"Building Construction","2.2.2":"Interior Finishing","3.1.1":"Electrical Design","3.1.2":"Electrical Installation","3.2.1":"Mechanical Installation","3.2.2":"HVAC System","3.3.1":"System Testing","3.3.2":"Commissioning"})[s]||"";return e.jsx(d,{...n,form:v,layout:"vertical",onFinish:E,initialValues:{...l,tanggal_issue:l!=null&&l.tanggal_issue?t(l.tanggal_issue):t(),deadline_resolution:l!=null&&l.deadline_resolution?t(l.deadline_resolution):null,tanggal_update_terkini:l!=null&&l.tanggal_update_terkini?t(l.tanggal_update_terkini):t(),deadline:l!=null&&l.deadline?t(l.deadline):null,...a&&(l!=null&&l.resolution_entries)?Object.fromEntries(l.resolution_entries.flatMap((s,i)=>[[`dampak_issue_${s.id}`,s.dampak_issue||""],[`pic_${s.id}`,s.pic||""],[`prioritas_issue_${s.id}`,s.prioritas_issue||""],[`resolution_${s.id}`,s.resolution||""],[`deadline_resolution_${s.id}`,s.deadline_resolution?t(s.deadline_resolution):null],[`deadline_${s.id}`,s.deadline?t(s.deadline):null],[`issue_update_${s.id}`,s.issue_update||""],[`tanggal_update_terkini_${s.id}`,s.tanggal_update_terkini?t(s.tanggal_update_terkini):null],[`progress_update_${s.id}`,s.progress_update||""],[`keterangan_${s.id}`,s.keterangan||""]])):{}},children:e.jsxs(S,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(f,{bodyStyle:{padding:0},bordered:!1,children:e.jsx(f,{title:"Issue Information",bodyStyle:{padding:24},children:e.jsxs(h,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Nomor Issue/Task ID",name:"wbs_task_id",rules:[{required:!0,message:"WBS/Task ID is required"}],children:e.jsx(p,{placeholder:"Select WBS/Task ID",options:C,disabled:a,onChange:s=>{v.setFieldsValue({aktivitas_master_schedule:F(s)})}})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Aktivitas di Master Schedule",name:"aktivitas_master_schedule",children:e.jsx(u,{placeholder:"Aktivitas will be auto-filled based on WBS",disabled:!0})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Tanggal Issue",name:"tanggal_issue",rules:[{required:!0,message:"Issue date is required"}],children:e.jsx(x,{style:{width:"100%"},placeholder:"Select issue date",disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Kategori Issue",name:"kategori_issue",rules:[{required:!0,message:"Issue category is required"}],children:e.jsx(p,{placeholder:"Select issue category",options:T,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Status Issue",name:"status_issue",rules:[{required:!0,message:"Issue status is required"}],children:e.jsx(p,{placeholder:"Select issue status",options:q,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Tipe Issue",name:"tipe_issue",rules:[{required:!0,message:"Issue type is required"}],children:e.jsx(p,{placeholder:"Select issue type",options:$,disabled:a})})}),e.jsx(r,{span:24,children:e.jsx(d.Item,{label:"Deskripsi Issue",name:"deskripsi_issue",rules:[{required:!0,message:"Issue description is required"}],children:e.jsx(u.TextArea,{placeholder:"Enter issue description",rows:4,disabled:a})})})]})})}),e.jsxs(f,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(c.Text,{strong:!0,style:{fontSize:"16px",margin:0},children:"Resolution & Update Summary"}),!a&&e.jsx(m,{type:"primary",icon:e.jsx(w,{}),onClick:()=>{const s=Math.max(...o.map(i=>i.id))+1;y([...o,{id:s}])},children:"Add New"})]}),e.jsx(S,{direction:"vertical",size:"large",style:{width:"100%"},children:o.map((s,i)=>e.jsxs("div",{style:{border:"1px solid #d9d9d9",borderRadius:"6px",padding:"16px",backgroundColor:"#fafafa"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingBottom:"8px",borderBottom:"1px solid #e8e8e8"},children:[e.jsxs(c.Text,{strong:!0,style:{fontSize:"14px"},children:["Entry ",i+1]}),o.length>1&&!a&&e.jsx(m,{type:"text",icon:e.jsx(W,{}),onClick:()=>{o.length>1&&y(o.filter(M=>M.id!==s.id))},danger:!0,size:"small"})]}),e.jsxs(h,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(r,{span:24,children:e.jsx(c.Text,{strong:!0,style:{marginBottom:"8px",display:"block"},children:"Issue Detail"})}),e.jsx(r,{span:24,children:e.jsx(d.Item,{label:"Dampak Issue",name:`dampak_issue_${s.id}`,rules:i===0?[{required:!0,message:"Dampak issue is required"}]:[],children:e.jsx(u.TextArea,{placeholder:"Enter dampak issue",rows:3,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"PIC",name:`pic_${s.id}`,rules:i===0?[{required:!0,message:"PIC is required"}]:[],children:e.jsx(p,{placeholder:"Select PIC",options:B,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Prioritas Issue",name:`prioritas_issue_${s.id}`,rules:i===0?[{required:!0,message:"Prioritas issue is required"}]:[],children:e.jsx(p,{placeholder:"Select issue priority",options:R,disabled:a})})})]}),e.jsxs(h,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(r,{span:24,children:e.jsx(c.Text,{strong:!0,style:{marginBottom:"8px",display:"block"},children:"Resolution Plan"})}),e.jsx(r,{span:24,children:e.jsx(d.Item,{label:"Resolution",name:`resolution_${s.id}`,rules:i===0?[{required:!0,message:"Resolution is required"}]:[],children:e.jsx(u.TextArea,{placeholder:"Enter resolution details",rows:4,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Deadline Resolution",name:`deadline_resolution_${s.id}`,rules:i===0?[{required:!0,message:"Resolution deadline is required"}]:[],children:e.jsx(x,{style:{width:"100%"},placeholder:"Select resolution deadline",disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Deadline",name:`deadline_${s.id}`,rules:i===0?[{required:!0,message:"Deadline is required"}]:[],children:e.jsx(x,{style:{width:"100%"},placeholder:"Select deadline",disabled:a})})})]}),e.jsxs(h,{gutter:16,children:[e.jsx(r,{span:24,children:e.jsx(c.Text,{strong:!0,style:{marginBottom:"8px",display:"block"},children:"Update Information"})}),e.jsx(r,{span:24,children:e.jsx(d.Item,{label:"Issue Update",name:`issue_update_${s.id}`,rules:i===0?[{required:!0,message:"Issue update is required"}]:[],children:e.jsx(u.TextArea,{placeholder:"Enter issue update",rows:3,disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Tanggal Update Terkini",name:`tanggal_update_terkini_${s.id}`,rules:i===0?[{required:!0,message:"Last update date is required"}]:[],children:e.jsx(x,{style:{width:"100%"},placeholder:"Select last update date",disabled:a})})}),e.jsx(r,{span:12,children:e.jsx(d.Item,{label:"Progress Update",name:`progress_update_${s.id}`,children:e.jsx(u,{placeholder:"Enter progress update",disabled:a})})}),e.jsx(r,{span:24,children:e.jsx(d.Item,{label:"Keterangan",name:`keterangan_${s.id}`,children:e.jsx(u.TextArea,{placeholder:"Enter additional remarks",rows:3,disabled:a})})})]})]},s.id))})]}),!a&&e.jsxs(k,{justify:"flex-end",gap:16,style:{marginTop:24},children:[e.jsx(m,{type:"text",disabled:I,onClick:b?()=>b({__cancel:!0}):()=>_(-1),children:"Cancel"}),e.jsx(m,{type:"primary",htmlType:"submit",loading:I,children:j?"Save Changes":"Create Issue"})]}),a&&e.jsx(k,{justify:"flex-end",gap:16,style:{marginTop:24},children:e.jsx(m,{type:"primary",onClick:()=>_(-1),children:"Close"})})]})})};export{V as I};
//# sourceMappingURL=issue-form-BE28AkRn.js.map
