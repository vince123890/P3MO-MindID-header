var j=t=>{throw TypeError(t)};var E=(t,e,s)=>e.has(t)||j("Cannot "+s);var i=(t,e,s)=>(E(t,e,"read from private field"),s?s.call(t):e.get(t)),S=(t,e,s)=>e.has(t)?j("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),w=(t,e,s,n)=>(E(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),C=(t,e,s)=>(E(t,e,"access private method"),s);import{a as f,u as T,j as B}from"./@react-router-BOJM2k20.js";import{S as F,s as J,h as K,g as L,n as A,u as q,a as z,b as N}from"./index-knJtj6sN.js";import{s as Q}from"./index-Cskjed0c.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="d03a75ee-676a-4f8b-b0a9-2f75bd6050cb",t._sentryDebugIdIdentifier="sentry-dbid-d03a75ee-676a-4f8b-b0a9-2f75bd6050cb")}catch{}var g,v,d,m,p,k,R,_,G=(_=class extends F{constructor(e,s){super();S(this,p);S(this,g);S(this,v);S(this,d);S(this,m);w(this,g,e),this.setOptions(s),this.bindMethods(),C(this,p,k).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var n;const s=this.options;this.options=i(this,g).defaultMutationOptions(e),J(this.options,s)||i(this,g).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,d),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&K(s.mutationKey)!==K(this.options.mutationKey)?this.reset():((n=i(this,d))==null?void 0:n.state.status)==="pending"&&i(this,d).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=i(this,d))==null||e.removeObserver(this)}onMutationUpdate(e){C(this,p,k).call(this),C(this,p,R).call(this,e)}getCurrentResult(){return i(this,v)}reset(){var e;(e=i(this,d))==null||e.removeObserver(this),w(this,d,void 0),C(this,p,k).call(this),C(this,p,R).call(this)}mutate(e,s){var n;return w(this,m,s),(n=i(this,d))==null||n.removeObserver(this),w(this,d,i(this,g).getMutationCache().build(i(this,g),this.options)),i(this,d).addObserver(this),i(this,d).execute(e)}},g=new WeakMap,v=new WeakMap,d=new WeakMap,m=new WeakMap,p=new WeakSet,k=function(){var s;const e=((s=i(this,d))==null?void 0:s.state)??L();w(this,v,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},R=function(e){A.batch(()=>{var s,n,r,c,o,h,l,b;if(i(this,m)&&this.hasListeners()){const a=i(this,v).variables,u=i(this,v).context,y={client:i(this,g),meta:this.options.meta,mutationKey:this.options.mutationKey};(e==null?void 0:e.type)==="success"?((n=(s=i(this,m)).onSuccess)==null||n.call(s,e.data,a,u,y),(c=(r=i(this,m)).onSettled)==null||c.call(r,e.data,null,a,u,y)):(e==null?void 0:e.type)==="error"&&((h=(o=i(this,m)).onError)==null||h.call(o,e.error,a,u,y),(b=(l=i(this,m)).onSettled)==null||b.call(l,void 0,e.error,a,u,y))}this.listeners.forEach(a=>{a(i(this,v))})})},_);function H(t,e){const s=q(),[n]=f.useState(()=>new G(s,t));f.useEffect(()=>{n.setOptions(t)},[n,t]);const r=f.useSyncExternalStore(f.useCallback(o=>n.subscribe(A.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),c=f.useCallback((o,h)=>{n.mutate(o,h).catch(z)},[n]);if(r.error&&N(n.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:c,mutateAsync:r.mutate}}const x={set:t=>localStorage.setItem("users",JSON.stringify(t)),get:()=>{const t=localStorage.getItem("users");return t?JSON.parse(t):void 0},remove:()=>localStorage.removeItem("users")};/*! js-cookie v3.0.5 | MIT */function O(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)t[n]=s[n]}return t}var V={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function M(t,e){function s(r,c,o){if(!(typeof document>"u")){o=O({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var h="";for(var l in o)o[l]&&(h+="; "+l,o[l]!==!0&&(h+="="+o[l].split(";")[0]));return document.cookie=r+"="+t.write(c,r)+h}}function n(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var c=document.cookie?document.cookie.split("; "):[],o={},h=0;h<c.length;h++){var l=c[h].split("="),b=l.slice(1).join("=");try{var a=decodeURIComponent(l[0]);if(o[a]=t.read(b,a),r===a)break}catch{}}return r?o[r]:o}}return Object.create({set:s,get:n,remove:function(r,c){s(r,"",O({},c,{expires:-1}))},withAttributes:function(r){return M(this.converter,O({},this.attributes,r))},withConverter:function(r){return M(O({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var I=M(V,{path:"/"});const U={set:t=>I.set("token",JSON.stringify(t)),get:()=>{const t=I.get("token");if(t)return JSON.parse(t)},remove:()=>I.remove("token")},W=async t=>new Promise((e,s)=>{setTimeout(()=>{t.username==="admin"&&t.password==="admin"?e({data:{access_token:"access_token",refresh_token:"refresh_token",user:{id:"1",name:"Ahmad Rio",role:"Admin",email:"admin@example.com"}}}):s({error:"Invalid username or password"})},1e3)}),X=()=>{const t=T();return H({mutationKey:["post-login"],mutationFn:async e=>await W(e),onSuccess:e=>{U.set(e.data),x.set({user:e.data.user}),t(0)},onError:e=>{Q.error(e.error)}})},P=f.createContext({signin:()=>{},signout:()=>{},switchRole:()=>{},session:void 0,status:void 0}),te=({children:t})=>{const e=T(),[s,n]=f.useState(),[r,c]=f.useState(),{mutate:o}=X();f.useEffect(()=>{const a=U.get(),u=x.get();a?(n({...a,...u}),c("authenticated")):c("unauthenticated")},[]);const h=a=>{c("authenticating"),o(a,{onSuccess:u=>{n(u.data),c("authenticated"),x.set(u.data),setTimeout(()=>{e("/project-anggota-holding")},600)},onError:()=>{c("unauthenticated")}})},l=(a={})=>{try{c("unauthenticated"),n(void 0),x.remove(),U.remove();const u=typeof(a==null?void 0:a.callbackUrl)=="string"?a.callbackUrl:"/auth/login";e(String(u))}catch(u){console.warn("Error during signout:",u),window.location.href="/auth/login"}},b=a=>{try{if(!s||!a){console.warn("Invalid session data or role for switch");return}const u={...s},y={...u.user,role:String(a)},D={...u,user:y};n(D),x.set(D),e("/project-anggota-holding")}catch(u){console.warn("Error switching role:",u)}};return B.jsx(P.Provider,{value:{session:s,status:r,signin:h,signout:l,switchRole:b},children:t})},se=()=>f.useContext(P);export{te as S,X as a,se as u};
//# sourceMappingURL=session-3xyvxnnm.js.map
