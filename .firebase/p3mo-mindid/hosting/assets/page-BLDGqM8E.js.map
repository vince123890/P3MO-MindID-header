{"version":3,"file":"page-BLDGqM8E.js","sources":["../../src/app/(protected)/projects/[id]/risks/[riskId]/update/page.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router\";\nimport { Page } from \"admiral\";\nimport { Modal, message, Form } from \"antd\";\n\nimport { RiskForm } from \"@/app/(protected)/projects/_components/risk-form.jsx\";\nimport { getRiskById, projectRisks } from \"@/app/(protected)/projects/_data/risks.js\";\n\nexport const Component = () => {\n  const { id, riskId } = useParams();\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n  const [riskData, setRiskData] = useState(null);\n\n  useEffect(() => {\n    const fetchRiskData = async () => {\n      setLoading(true);\n      try {\n        const response = await getRiskById(riskId);\n        if (response.data) {\n          setRiskData(response.data);\n        } else {\n          message.error(\"Risk not found\");\n          navigate(`/projects/${id}`);\n        }\n      } catch (error) {\n        message.error(\"Failed to fetch risk data\");\n        navigate(`/projects/${id}`);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchRiskData();\n  }, [riskId, id, navigate]);\n\n  const breadcrumbs = [\n    {\n      label: \"Projects\",\n      path: \"/projects\",\n    },\n    {\n      label: \"Project Detail\",\n      path: `/projects/${id}`,\n    },\n    {\n      label: \"Risks\",\n      path: `/projects/${id}/risks`,\n    },\n    {\n      label: `Edit Risk ${riskData?.nomor_resiko || riskId}`,\n      path: `/projects/${id}/risks/${riskId}/update`,\n    },\n  ];\n\n  const handleFinish = (values) => {\n    setLoading(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      try {\n        // Find the risk index in the array\n        const riskIndex = projectRisks.data.items.findIndex(item => item.id === riskId);\n        \n        if (riskIndex !== -1) {\n          // Update the risk data\n          projectRisks.data.items[riskIndex] = {\n            ...projectRisks.data.items[riskIndex],\n            ...values,\n            updated_at: new Date().toISOString(),\n          };\n          \n          message.success(\"Risk updated successfully\");\n          navigate(`/projects/${id}`);\n        } else {\n          message.error(\"Risk not found\");\n        }\n      } catch (error) {\n        message.error(\"Failed to update risk\");\n      } finally {\n        setLoading(false);\n      }\n    }, 1000);\n  };\n\n  return (\n    <Page\n      title={`Edit Risk - ${riskData?.nomor_resiko || 'Loading...'}`}\n      breadcrumbs={breadcrumbs}\n      loading={loading}\n    >\n      <Modal\n        title={`Edit Risk - ${riskData?.nomor_resiko || 'Loading...'}`}\n        open={true}\n        onCancel={() => navigate(-1)}\n        footer={null}\n        width={1200}\n        centered\n        styles={{\n          body: {\n            maxHeight: '80vh',\n            overflowY: 'auto'\n          }\n        }}\n      >\n        <RiskForm\n          formProps={{\n            form,\n            onFinish: handleFinish,\n          }}\n          initialData={riskData}\n          loading={loading}\n          isEdit={true}\n          onSubmit={handleFinish}\n        />\n      </Modal>\n    </Page>\n  );\n};\n\nexport default Component;\n"],"names":["Component","id","riskId","useParams","navigate","useNavigate","form","Form","loading","setLoading","useState","riskData","setRiskData","useEffect","response","getRiskById","message","breadcrumbs","handleFinish","values","riskIndex","projectRisks","item","jsx","Page","Modal","RiskForm"],"mappings":"kzCAQO,MAAMA,EAAY,IAAM,CAC7B,KAAM,CAAE,GAAAC,EAAI,OAAAC,CAAA,EAAWC,EAAA,EACjBC,EAAWC,EAAA,EACX,CAACC,CAAI,EAAIC,EAAK,QAAA,EACd,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EACtC,CAACC,EAAUC,CAAW,EAAIF,EAAAA,SAAS,IAAI,EAE7CG,EAAAA,UAAU,IAAM,EACQ,SAAY,CAChCJ,EAAW,EAAI,EACf,GAAI,CACF,MAAMK,EAAW,MAAMC,EAAYb,CAAM,EACrCY,EAAS,KACXF,EAAYE,EAAS,IAAI,GAEzBE,EAAQ,MAAM,gBAAgB,EAC9BZ,EAAS,aAAaH,CAAE,EAAE,EAE9B,MAAgB,CACde,EAAQ,MAAM,2BAA2B,EACzCZ,EAAS,aAAaH,CAAE,EAAE,CAC5B,QAAA,CACEQ,EAAW,EAAK,CAClB,CACF,GAEA,CACF,EAAG,CAACP,EAAQD,EAAIG,CAAQ,CAAC,EAEzB,MAAMa,EAAc,CAClB,CACE,MAAO,WACP,KAAM,WAAA,EAER,CACE,MAAO,iBACP,KAAM,aAAahB,CAAE,EAAA,EAEvB,CACE,MAAO,QACP,KAAM,aAAaA,CAAE,QAAA,EAEvB,CACE,MAAO,cAAaU,GAAA,YAAAA,EAAU,eAAgBT,CAAM,GACpD,KAAM,aAAaD,CAAE,UAAUC,CAAM,SAAA,CACvC,EAGIgB,EAAgBC,GAAW,CAC/BV,EAAW,EAAI,EAGf,WAAW,IAAM,CACf,GAAI,CAEF,MAAMW,EAAYC,EAAa,KAAK,MAAM,UAAUC,GAAQA,EAAK,KAAOpB,CAAM,EAE1EkB,IAAc,IAEhBC,EAAa,KAAK,MAAMD,CAAS,EAAI,CACnC,GAAGC,EAAa,KAAK,MAAMD,CAAS,EACpC,GAAGD,EACH,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAGrCH,EAAQ,QAAQ,2BAA2B,EAC3CZ,EAAS,aAAaH,CAAE,EAAE,GAE1Be,EAAQ,MAAM,gBAAgB,CAElC,MAAgB,CACdA,EAAQ,MAAM,uBAAuB,CACvC,QAAA,CACEP,EAAW,EAAK,CAClB,CACF,EAAG,GAAI,CACT,EAEA,OACEc,EAAAA,IAACC,EAAA,CACC,MAAO,gBAAeb,GAAA,YAAAA,EAAU,eAAgB,YAAY,GAC5D,YAAAM,EACA,QAAAT,EAEA,SAAAe,EAAAA,IAACE,EAAA,CACC,MAAO,gBAAed,GAAA,YAAAA,EAAU,eAAgB,YAAY,GAC5D,KAAM,GACN,SAAU,IAAMP,EAAS,EAAE,EAC3B,OAAQ,KACR,MAAO,KACP,SAAQ,GACR,OAAQ,CACN,KAAM,CACJ,UAAW,OACX,UAAW,MAAA,CACb,EAGF,SAAAmB,EAAAA,IAACG,EAAA,CACC,UAAW,CACT,KAAApB,EACA,SAAUY,CAAA,EAEZ,YAAaP,EACb,QAAAH,EACA,OAAQ,GACR,SAAUU,CAAA,CAAA,CACZ,CAAA,CACF,CAAA,CAGN"}