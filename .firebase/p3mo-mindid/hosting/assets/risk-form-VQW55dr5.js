import{u as P,a as z,j as e}from"./@react-router-BOJM2k20.js";import{d as m,S as M,R as j,C as r,a as R,F as q}from"./index-BafWvN44.js";import{S as g}from"./index-BGD_4JXV.js";import{u as U}from"./use-form-error-handling-Dj-OCOIU.js";import{F as a}from"./index-DDk6ch2l.js";import{I as o}from"./index-BpdQMdSc.js";import{S as h}from"./index-HUJMorX5.js";import{T as y}from"./index-QOKA2q-x.js";import{B as x}from"./index-BHxSUtD9.js";import{R as K}from"./PlusOutlined-Dx_yv4bP.js";import{R as N}from"./DeleteOutlined-DO7ccZ5J.js";import{s as G}from"./index-Cskjed0c.js";try{let d=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},b=new d.Error().stack;b&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[b]="8e7b3a5a-33d3-48a9-998d-215c9fe51712",d._sentryDebugIdIdentifier="sentry-dbid-8e7b3a5a-33d3-48a9-998d-215c9fe51712")}catch{}const ae=({formProps:d,error:b,loading:v,isEdit:f=!1,isView:i=!1,initialData:l=null,onSubmit:I})=>{const[k]=a.useForm(),_=P(),[n,S]=z.useState([{id:1}]);U(b,({key:s,message:t})=>k.setFields([{name:s,errors:[t]}]));const C=[{label:"Technical",value:"Technical"},{label:"Financial",value:"Financial"},{label:"Operational",value:"Operational"},{label:"Environmental",value:"Environmental"},{label:"Safety",value:"Safety"},{label:"Regulatory",value:"Regulatory"},{label:"Strategic",value:"Strategic"},{label:"Reputational",value:"Reputational"}],T=[{label:"Very Low",value:"Very Low"},{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Very High",value:"Very High"}],w=[{label:"Very Low",value:"Very Low"},{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],L=[{label:"Low",value:"Low"},{label:"Medium",value:"Medium"},{label:"High",value:"High"},{label:"Critical",value:"Critical"}],H=[{label:"Open",value:"Open"},{label:"In Progress",value:"In Progress"},{label:"Resolved",value:"Resolved"},{label:"Closed",value:"Closed"},{label:"On Hold",value:"On Hold"}],F=s=>{I?I(s):(G.success(f?"Risk updated successfully":"Risk created successfully"),_(-1))},E=(s,t)=>{const c={"Very Low":1,Low:2,Medium:3,High:4,"Very High":5},p={"Very Low":1,Low:2,Medium:3,High:4,Critical:5},u=c[s]||1,B=p[t]||1,$=(u+B)/2,A=Math.round($*2);return Math.min(Math.max(A,1),10)},O=s=>{const c={...k.getFieldsValue(),...s};if(s.probabilitas_resiko||s.tingkat_dampak){const p=E(c.probabilitas_resiko,c.tingkat_dampak);let u="Low";p>=8?u="Critical":p>=6?u="High":p>=4&&(u="Medium"),k.setFieldsValue({skor_resiko:p,prioritas_resiko:u})}};return e.jsx(a,{...d,form:k,layout:"vertical",onFinish:F,onFieldsChange:O,initialValues:{...l,tanggal_identifikasi_resiko:l!=null&&l.tanggal_identifikasi_resiko?m(l.tanggal_identifikasi_resiko):m(),deadline_mitigasi:l!=null&&l.deadline_mitigasi?m(l.deadline_mitigasi):null,tanggal_update_terkini:l!=null&&l.tanggal_update_terkini?m(l.tanggal_update_terkini):m(),skor_resiko:(l==null?void 0:l.skor_resiko)||1},children:e.jsxs(M,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(g,{bodyStyle:{padding:0},bordered:!1,children:e.jsx(g,{title:"Risk Identification",children:e.jsxs(j,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Nomor Resiko",name:"nomor_resiko",rules:[{required:!0,message:"Risk number is required"}],children:e.jsx(o,{placeholder:"RSK-001",disabled:i||f})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Tanggal Identifikasi Resiko",name:"tanggal_identifikasi_resiko",rules:[{required:!0,message:"Risk identification date is required"}],children:e.jsx(R,{style:{width:"100%"},placeholder:"Select identification date",disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Kategori Resiko",name:"kategori_resiko",rules:[{required:!0,message:"Risk category is required"}],children:e.jsx(h,{placeholder:"Select risk category",options:C,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Probabilitas Resiko",name:"probabilitas_resiko",rules:[{required:!0,message:"Risk probability is required"}],children:e.jsx(h,{placeholder:"Select risk probability",options:T,disabled:i})})})]})})}),e.jsx(g,{bodyStyle:{padding:0},bordered:!1,children:e.jsx(g,{title:"Risk Description",children:e.jsxs(j,{gutter:16,children:[e.jsx(r,{span:24,children:e.jsx(a.Item,{label:"Deskripsi Resiko",name:"deskripsi_resiko",rules:[{required:!0,message:"Risk description is required"}],children:e.jsx(o.TextArea,{placeholder:"Enter detailed risk description",rows:4,disabled:i})})}),e.jsx(r,{span:24,children:e.jsx(a.Item,{label:"Dampak Resiko",name:"dampak_resiko",rules:[{required:!0,message:"Risk impact is required"}],children:e.jsx(o.TextArea,{placeholder:"Enter potential impact of the risk",rows:3,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Tingkat Dampak",name:"tingkat_dampak",rules:[{required:!0,message:"Impact level is required"}],children:e.jsx(h,{placeholder:"Select impact level",options:w,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Skor Resiko",name:"skor_resiko",children:e.jsx(o,{placeholder:"Risk score (calculated automatically)",disabled:!0,addonAfter:"/10"})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Prioritas Resiko",name:"prioritas_resiko",rules:[{required:!0,message:"Risk priority is required"}],children:e.jsx(h,{placeholder:"Select risk priority",options:L,disabled:i})})})]})})}),e.jsxs(g,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx(y.Text,{strong:!0,style:{fontSize:"16px",margin:0},children:"Mitigation & Update Summary"}),!i&&e.jsx(x,{type:"primary",icon:e.jsx(K,{}),onClick:()=>{const s=Math.max(...n.map(t=>t.id))+1;S([...n,{id:s}])},children:"Add New"})]}),e.jsx(M,{direction:"vertical",size:"large",style:{width:"100%"},children:n.map((s,t)=>e.jsxs("div",{style:{border:"1px solid #d9d9d9",borderRadius:"6px",padding:"16px",backgroundColor:"#fafafa"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingBottom:"8px",borderBottom:"1px solid #e8e8e8"},children:[e.jsxs(y.Text,{strong:!0,style:{fontSize:"14px"},children:["Entry ",t+1]}),n.length>1&&!i&&e.jsx(x,{type:"text",icon:e.jsx(N,{}),onClick:()=>{n.length>1&&S(n.filter(c=>c.id!==s.id))},danger:!0,size:"small"})]}),e.jsxs(j,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(r,{span:24,children:e.jsx(y.Text,{strong:!0,style:{marginBottom:"8px",display:"block"},children:"Mitigation Plan"})}),e.jsx(r,{span:24,children:e.jsx(a.Item,{label:"Rencana Mitigasi",name:`rencana_mitigasi_${s.id}`,rules:t===0?[{required:!0,message:"Mitigation plan is required"}]:[],children:e.jsx(o.TextArea,{placeholder:"Enter detailed mitigation plan",rows:4,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Status Mitigasi",name:`status_mitigasi_${s.id}`,rules:t===0?[{required:!0,message:"Mitigation status is required"}]:[],children:e.jsx(h,{placeholder:"Select mitigation status",options:H,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Deadline Mitigasi",name:`deadline_mitigasi_${s.id}`,rules:t===0?[{required:!0,message:"Mitigation deadline is required"}]:[],children:e.jsx(R,{style:{width:"100%"},placeholder:"Select mitigation deadline",disabled:i})})})]}),e.jsxs(j,{gutter:16,children:[e.jsx(r,{span:24,children:e.jsx(y.Text,{strong:!0,style:{marginBottom:"8px",display:"block"},children:"Update Information"})}),e.jsx(r,{span:24,children:e.jsx(a.Item,{label:"Update Mitigasi",name:`update_mitigasi_${s.id}`,rules:t===0?[{required:!0,message:"Mitigation update is required"}]:[],children:e.jsx(o.TextArea,{placeholder:"Enter latest mitigation update",rows:3,disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"Tanggal Update Terkini",name:`tanggal_update_terkini_${s.id}`,rules:t===0?[{required:!0,message:"Last update date is required"}]:[],children:e.jsx(R,{style:{width:"100%"},placeholder:"Select last update date",disabled:i})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{label:"PIC",name:`pic_${s.id}`,children:e.jsx(o,{placeholder:"Enter person in charge",disabled:i})})}),e.jsx(r,{span:24,children:e.jsx(a.Item,{label:"Keterangan",name:`keterangan_${s.id}`,children:e.jsx(o.TextArea,{placeholder:"Enter additional remarks",rows:2,disabled:i})})})]})]},s.id))})]}),!i&&e.jsxs(q,{justify:"flex-end",gap:16,style:{marginTop:24},children:[e.jsx(x,{type:"text",disabled:v,onClick:()=>_(-1),children:"Cancel"}),e.jsx(x,{type:"primary",htmlType:"submit",loading:v,children:f?"Save Changes":"Create Risk"})]}),i&&e.jsx(q,{justify:"flex-end",gap:16,style:{marginTop:24},children:e.jsx(x,{type:"primary",onClick:()=>_(-1),children:"Close"})})]})})};export{ae as R};
//# sourceMappingURL=risk-form-VQW55dr5.js.map
