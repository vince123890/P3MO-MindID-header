{"version":3,"file":"page-CXduZSwz.js","sources":["../../src/app/(protected)/projects/[id]/issues/create/page.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router\";\nimport { Page } from \"admiral\";\nimport { Modal, message, Form } from \"antd\";\n\nimport { IssueForm } from \"@/app/(protected)/projects/_components/issue-form.jsx\";\nimport { projectIssues } from \"@/app/(protected)/projects/_data/issues.js\";\n\nexport const Component = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n\n  const breadcrumbs = [\n    {\n      label: \"Projects\",\n      path: \"/projects\",\n    },\n    {\n      label: \"Project Detail\",\n      path: `/projects/${id}`,\n    },\n    {\n      label: \"Issues\",\n      path: `/projects/${id}/issues`,\n    },\n    {\n      label: \"Create Issue\",\n      path: `/projects/${id}/issues/create`,\n    },\n  ];\n\n  const handleFinish = (values) => {\n    setLoading(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      try {\n        // Generate new issue ID\n        const newId = String(Math.max(...projectIssues.data.items.map(item => parseInt(item.id)), 0) + 1);\n        \n        // Generate issue number - get the highest number for this project and increment\n        const projectIssuesFiltered = projectIssues.data.items\n          .filter(item => item.project_id === id)\n          .map(item => {\n            const match = item.nomor_issue.match(/ISS-(\\d+)/);\n            return match ? parseInt(match[1]) : 0;\n          });\n        \n        const lastIssueNumber = projectIssuesFiltered.length > 0 ? Math.max(...projectIssuesFiltered) : 0;\n        const issueNumber = `ISS-${String(lastIssueNumber + 1).padStart(3, '0')}`;\n        \n        // Create new issue object\n        const newIssue = {\n          id: newId,\n          project_id: id,\n          nomor_issue: issueNumber,\n          ...values,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString(),\n        };\n        \n        // Add to issues array (in real app, this would be an API call)\n        projectIssues.data.items.push(newIssue);\n        \n        message.success(\"Issue created successfully\");\n        navigate(`/projects/${id}`);\n      } catch (error) {\n        message.error(\"Failed to create issue\");\n      } finally {\n        setLoading(false);\n      }\n    }, 1000);\n  };\n\n  return (\n    <Page\n      title=\"Create Issue\"\n      breadcrumbs={breadcrumbs}\n    >\n      <Modal\n        title=\"Create New Issue\"\n        open={true}\n        onCancel={() => navigate(-1)}\n        footer={null}\n        width={1200}\n        centered\n        styles={{\n          body: {\n            maxHeight: '80vh',\n            overflowY: 'auto'\n          }\n        }}\n      >\n        <IssueForm\n          formProps={{\n            form,\n            onFinish: handleFinish,\n          }}\n          loading={loading}\n          onSubmit={handleFinish}\n        />\n      </Modal>\n    </Page>\n  );\n};\n\nexport default Component;\n"],"names":["Component","id","useParams","navigate","useNavigate","form","Form","loading","setLoading","useState","breadcrumbs","handleFinish","values","newId","projectIssues","item","projectIssuesFiltered","match","lastIssueNumber","issueNumber","newIssue","message","jsx","Page","Modal","IssueForm"],"mappings":"kzCAQO,MAAMA,EAAY,IAAM,CAC7B,KAAM,CAAE,GAAAC,CAAA,EAAOC,EAAA,EACTC,EAAWC,EAAA,EACX,CAACC,CAAI,EAAIC,EAAK,QAAA,EACd,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EAEtCC,EAAc,CAClB,CACE,MAAO,WACP,KAAM,WAAA,EAER,CACE,MAAO,iBACP,KAAM,aAAaT,CAAE,EAAA,EAEvB,CACE,MAAO,SACP,KAAM,aAAaA,CAAE,SAAA,EAEvB,CACE,MAAO,eACP,KAAM,aAAaA,CAAE,gBAAA,CACvB,EAGIU,EAAgBC,GAAW,CAC/BJ,EAAW,EAAI,EAGf,WAAW,IAAM,CACf,GAAI,CAEF,MAAMK,EAAQ,OAAO,KAAK,IAAI,GAAGC,EAAc,KAAK,MAAM,IAAIC,GAAQ,SAASA,EAAK,EAAE,CAAC,EAAG,CAAC,EAAI,CAAC,EAG1FC,EAAwBF,EAAc,KAAK,MAC9C,OAAOC,GAAQA,EAAK,aAAed,CAAE,EACrC,IAAIc,GAAQ,CACX,MAAME,EAAQF,EAAK,YAAY,MAAM,WAAW,EAChD,OAAOE,EAAQ,SAASA,EAAM,CAAC,CAAC,EAAI,CACtC,CAAC,EAEGC,EAAkBF,EAAsB,OAAS,EAAI,KAAK,IAAI,GAAGA,CAAqB,EAAI,EAC1FG,EAAc,OAAO,OAAOD,EAAkB,CAAC,EAAE,SAAS,EAAG,GAAG,CAAC,GAGjEE,EAAW,CACf,GAAIP,EACJ,WAAYZ,EACZ,YAAakB,EACb,GAAGP,EACH,WAAY,IAAI,KAAA,EAAO,YAAA,EACvB,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAIrCE,EAAc,KAAK,MAAM,KAAKM,CAAQ,EAEtCC,EAAQ,QAAQ,4BAA4B,EAC5ClB,EAAS,aAAaF,CAAE,EAAE,CAC5B,MAAgB,CACdoB,EAAQ,MAAM,wBAAwB,CACxC,QAAA,CACEb,EAAW,EAAK,CAClB,CACF,EAAG,GAAI,CACT,EAEA,OACEc,EAAAA,IAACC,EAAA,CACC,MAAM,eACN,YAAAb,EAEA,SAAAY,EAAAA,IAACE,EAAA,CACC,MAAM,mBACN,KAAM,GACN,SAAU,IAAMrB,EAAS,EAAE,EAC3B,OAAQ,KACR,MAAO,KACP,SAAQ,GACR,OAAQ,CACN,KAAM,CACJ,UAAW,OACX,UAAW,MAAA,CACb,EAGF,SAAAmB,EAAAA,IAACG,EAAA,CACC,UAAW,CACT,KAAApB,EACA,SAAUM,CAAA,EAEZ,QAAAJ,EACA,SAAUI,CAAA,CAAA,CACZ,CAAA,CACF,CAAA,CAGN"}