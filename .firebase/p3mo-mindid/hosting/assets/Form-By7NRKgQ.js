import{u as H,a as p,j as e}from"./@react-router-BOJM2k20.js";import{S as L,R as j,C as n,F as O}from"./index-BafWvN44.js";import{S as m}from"./index-BGD_4JXV.js";import{u as P}from"./use-form-error-handling-Dj-OCOIU.js";import{l as N}from"./index-BsmfOC0k.js";import{a as y}from"./index-V7rvPLgr.js";import{F as l}from"./index-DDk6ch2l.js";import{I as A}from"./index-BpdQMdSc.js";import{R as _}from"./EditOutlined-ILeNmOcc.js";import{T as f}from"./index-QOKA2q-x.js";import{R as q}from"./EyeOutlined-C2nNK8zw.js";import{S as s}from"./index-HUJMorX5.js";import{T as B}from"./index-CrLFCoSO.js";import{B as v}from"./index-BHxSUtD9.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new r.Error().stack;i&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[i]="4469388c-db6d-425a-8ca3-853b84309365",r._sentryDebugIdIdentifier="sentry-dbid-4469388c-db6d-425a-8ca3-853b84309365")}catch{}const{TextArea:w}=A,se=({formProps:r,error:i,loading:u,isEdit:S})=>{const[d]=l.useForm(),T=H(),[z,h]=p.useState(null),[c,x]=p.useState(""),[C,I]=p.useState("edit");P(i,({key:t,message:a})=>d.setFields([{name:t,errors:[a]}]));const b=N.data.items.filter(t=>t.status==="Active").map(t=>({label:t.nama_user,value:t.nama_user})),M=y.data.items.filter(t=>t.status==="Active").map(t=>({label:t.nama_template,value:t.id,body:t.body})),k=t=>{if(t){const a=y.data.items.find(o=>o.id===t);a&&(d.setFieldsValue({body:a.body}),x(a.body),h(a))}else h(null)},E=t=>{const a=t.target.value;x(a),d.setFieldsValue({body:a})},F=t=>{if(!t)return'<p style="color: #999;">No content available</p>';const a={"[Name]":"John Doe","[Date]":new Date().toLocaleDateString(),"[Project Name]":"Sample Project","[Status]":"Active","[Contact]":"contact@example.com"};let o=t;return Object.keys(a).forEach(g=>{const D=new RegExp(g.replace(/\[|\]/g,"\\$&"),"g");o=o.replace(D,a[g])}),o},R=[{key:"edit",label:e.jsxs("span",{children:[e.jsx(_,{}),"Edit Content"]}),children:e.jsx(w,{value:c,onChange:E,rows:12,placeholder:`Enter message body content (HTML supported)

Available placeholders:
- [Name] - Recipient name
- [Date] - Current date
- [Project Name] - Project name
- [Status] - Status value
- [Contact] - Contact information

You can also select a template above to load pre-formatted content.

Example:
<h2>Message Title</h2>
<p>Hello <strong>[Name]</strong>,</p>
<p>Your message content here...</p>`,style:{fontFamily:"monospace"}})},{key:"preview",label:e.jsxs("span",{children:[e.jsx(q,{}),"HTML Preview"]}),children:e.jsxs("div",{style:{border:"1px solid #d9d9d9",borderRadius:"6px",padding:"16px",backgroundColor:"#fafafa",minHeight:"300px"},children:[e.jsx(f.Text,{type:"secondary",style:{fontSize:"12px",display:"block",marginBottom:"8px"},children:"HTML Preview (with sample placeholder values):"}),e.jsx("div",{style:{backgroundColor:"white",padding:"16px",borderRadius:"4px",border:"1px solid #e8e8e8",minHeight:"150px"},dangerouslySetInnerHTML:{__html:F(c)}}),e.jsx(f.Text,{type:"secondary",style:{fontSize:"12px",display:"block",marginTop:"16px",marginBottom:"8px"},children:"Raw HTML Code:"}),e.jsx("div",{style:{backgroundColor:"#f5f5f5",padding:"12px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"150px",overflow:"auto",border:"1px solid #e8e8e8"},children:c||"No content available"})]})}];return e.jsxs(l,{...r,form:d,layout:"vertical",children:[e.jsx(m,{children:e.jsxs(L,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(m,{title:"Message Recipients",children:e.jsxs(j,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(l.Item,{label:"To",name:"to",rules:[{required:!0,message:"At least one recipient is required"}],children:e.jsx(s,{mode:"multiple",placeholder:"Select recipients",showSearch:!0,filterOption:(t,a)=>a.label.toLowerCase().includes(t.toLowerCase()),children:b.map(t=>e.jsx(s.Option,{value:t.value,children:t.label},t.value))})})}),e.jsx(n,{span:12,children:e.jsx(l.Item,{label:"CC",name:"cc",children:e.jsx(s,{mode:"multiple",placeholder:"Select CC recipients (optional)",showSearch:!0,filterOption:(t,a)=>a.label.toLowerCase().includes(t.toLowerCase()),children:b.map(t=>e.jsx(s.Option,{value:t.value,children:t.label},t.value))})})}),e.jsx(n,{span:12,children:e.jsx(l.Item,{label:"Via",name:"via",rules:[{required:!0,message:"Delivery method is required"}],children:e.jsxs(s,{placeholder:"Select delivery method",children:[e.jsx(s.Option,{value:"Apps",children:"Apps"}),e.jsx(s.Option,{value:"Email",children:"Email"}),e.jsx(s.Option,{value:"Keduanya",children:"Keduanya"})]})})})]})}),e.jsx(m,{title:"Message Content",children:e.jsxs(j,{gutter:16,children:[e.jsx(n,{span:24,children:e.jsx(l.Item,{label:"Subject",name:"subject",rules:[{required:!0,message:"Subject is required"},{min:5,message:"Subject must be at least 5 characters"}],children:e.jsx(w,{rows:2,placeholder:"Enter message subject"})})}),e.jsx(n,{span:24,children:e.jsx(l.Item,{label:"Add Template (Optional)",name:"template_id",children:e.jsx(s,{placeholder:"Select template to load content",allowClear:!0,onChange:k,children:M.map(t=>e.jsx(s.Option,{value:t.value,children:t.label},t.value))})})}),e.jsxs(n,{span:24,children:[e.jsx(l.Item,{label:"Body",name:"body",rules:[{required:!0,message:"Message body is required"},{min:10,message:"Message body must be at least 10 characters"}],children:e.jsx(B,{activeKey:C,onChange:I,items:R,size:"small"})}),e.jsxs("div",{style:{marginTop:8,fontSize:"12px",color:"#666"},children:[e.jsx("strong",{children:"Note:"})," This field supports HTML formatting. Use placeholders like [Name], [Date], [Project Name] for dynamic content.",e.jsx("br",{}),e.jsx("strong",{children:"Template Integration:"})," Select a template above to automatically load pre-formatted content.",e.jsx("br",{}),e.jsx("strong",{children:"Preview:"}),' Switch to the "HTML Preview" tab to see how your content will look when rendered.',e.jsx("br",{}),e.jsx("strong",{children:"Future Enhancement:"})," This will be replaced with a TinyMCE WYSIWYG editor for better content editing experience."]})]})]})})]})}),e.jsxs(O,{justify:"flex-end",gap:16,style:{marginTop:24},children:[e.jsx(v,{type:"text",disabled:u,onClick:()=>T("/messaging"),children:"Cancel"}),e.jsx(v,{type:"primary",htmlType:"submit",loading:u,children:S?"Update Message":"Send Message"})]})]})};export{se as F};
//# sourceMappingURL=Form-By7NRKgQ.js.map
