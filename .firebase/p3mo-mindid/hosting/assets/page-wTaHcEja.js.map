{"version":3,"file":"page-wTaHcEja.js","sources":["../../src/app/(protected)/projects/[id]/issues/[issueId]/update/page.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router\";\nimport { Page } from \"admiral\";\nimport { Modal, message, Form } from \"antd\";\n\nimport { IssueForm } from \"@/app/(protected)/projects/_components/issue-form.jsx\";\nimport { getIssueById, projectIssues } from \"@/app/(protected)/projects/_data/issues.js\";\n\nexport const Component = () => {\n  const { id, issueId } = useParams();\n  const navigate = useNavigate();\n  const [form] = Form.useForm();\n  const [loading, setLoading] = useState(false);\n\n  const issueData = getIssueById(issueId);\n\n  const breadcrumbs = [\n    {\n      label: \"Projects\",\n      path: \"/projects\",\n    },\n    {\n      label: \"Project Detail\",\n      path: `/projects/${id}`,\n    },\n    {\n      label: \"Issues\",\n      path: `/projects/${id}/issues`,\n    },\n    {\n      label: \"Edit Issue\",\n      path: `/projects/${id}/issues/${issueId}/update`,\n    },\n  ];\n\n  const handleFinish = (values) => {\n    setLoading(true);\n    \n    // Simulate API call\n    setTimeout(() => {\n      try {\n        // Validate issue exists\n        if (!issueData.data) {\n          message.error(\"Issue not found\");\n          setLoading(false);\n          return;\n        }\n\n        // Find and update the issue\n        const issueIndex = projectIssues.data.items.findIndex(item => item.id === issueId);\n        \n        if (issueIndex !== -1) {\n          // Update the issue with new values\n          projectIssues.data.items[issueIndex] = {\n            ...projectIssues.data.items[issueIndex],\n            ...values,\n            updated_at: new Date().toISOString(),\n          };\n          \n          message.success(\"Issue updated successfully\");\n          navigate(`/projects/${id}`);\n        } else {\n          message.error(\"Issue not found in data\");\n        }\n      } catch (error) {\n        console.error(\"Update error:\", error);\n        message.error(\"Failed to update issue: \" + (error.message || \"Unknown error\"));\n      } finally {\n        setLoading(false);\n      }\n    }, 1000);\n  };\n\n  if (!issueData.data) {\n    return (\n      <Page\n        title=\"Issue Not Found\"\n        breadcrumbs={breadcrumbs}\n      >\n        <div>Issue not found</div>\n      </Page>\n    );\n  }\n\n  return (\n    <Page\n      title=\"Edit Issue\"\n      breadcrumbs={breadcrumbs}\n    >\n      <Modal\n        title={`Edit Issue - ${issueData.data.nomor_issue}`}\n        open={true}\n        onCancel={() => navigate(-1)}\n        footer={null}\n        width={1200}\n        centered\n        styles={{\n          body: {\n            maxHeight: '80vh',\n            overflowY: 'auto'\n          }\n        }}\n      >\n        <IssueForm\n          formProps={{\n            form,\n            onFinish: handleFinish,\n          }}\n          loading={loading}\n          isEdit={true}\n          initialData={issueData.data}\n          onSubmit={handleFinish}\n        />\n      </Modal>\n    </Page>\n  );\n};\n\nexport default Component;\n"],"names":["Component","id","issueId","useParams","navigate","useNavigate","form","Form","loading","setLoading","useState","issueData","getIssueById","breadcrumbs","handleFinish","values","message","issueIndex","projectIssues","item","error","jsx","Page","Modal","IssueForm"],"mappings":"yzCAQO,MAAMA,EAAY,IAAM,CAC7B,KAAM,CAAE,GAAAC,EAAI,QAAAC,CAAA,EAAYC,EAAA,EAClBC,EAAWC,EAAA,EACX,CAACC,CAAI,EAAIC,EAAK,QAAA,EACd,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EAEtCC,EAAYC,EAAaV,CAAO,EAEhCW,EAAc,CAClB,CACE,MAAO,WACP,KAAM,WAAA,EAER,CACE,MAAO,iBACP,KAAM,aAAaZ,CAAE,EAAA,EAEvB,CACE,MAAO,SACP,KAAM,aAAaA,CAAE,SAAA,EAEvB,CACE,MAAO,aACP,KAAM,aAAaA,CAAE,WAAWC,CAAO,SAAA,CACzC,EAGIY,EAAgBC,GAAW,CAC/BN,EAAW,EAAI,EAGf,WAAW,IAAM,CACf,GAAI,CAEF,GAAI,CAACE,EAAU,KAAM,CACnBK,EAAQ,MAAM,iBAAiB,EAC/BP,EAAW,EAAK,EAChB,MACF,CAGA,MAAMQ,EAAaC,EAAc,KAAK,MAAM,UAAUC,GAAQA,EAAK,KAAOjB,CAAO,EAE7Ee,IAAe,IAEjBC,EAAc,KAAK,MAAMD,CAAU,EAAI,CACrC,GAAGC,EAAc,KAAK,MAAMD,CAAU,EACtC,GAAGF,EACH,WAAY,IAAI,KAAA,EAAO,YAAA,CAAY,EAGrCC,EAAQ,QAAQ,4BAA4B,EAC5CZ,EAAS,aAAaH,CAAE,EAAE,GAE1Be,EAAQ,MAAM,yBAAyB,CAE3C,OAASI,EAAO,CACd,QAAQ,MAAM,gBAAiBA,CAAK,EACpCJ,EAAQ,MAAM,4BAA8BI,EAAM,SAAW,gBAAgB,CAC/E,QAAA,CACEX,EAAW,EAAK,CAClB,CACF,EAAG,GAAI,CACT,EAEA,OAAKE,EAAU,KAYbU,EAAAA,IAACC,EAAA,CACC,MAAM,aACN,YAAAT,EAEA,SAAAQ,EAAAA,IAACE,EAAA,CACC,MAAO,gBAAgBZ,EAAU,KAAK,WAAW,GACjD,KAAM,GACN,SAAU,IAAMP,EAAS,EAAE,EAC3B,OAAQ,KACR,MAAO,KACP,SAAQ,GACR,OAAQ,CACN,KAAM,CACJ,UAAW,OACX,UAAW,MAAA,CACb,EAGF,SAAAiB,EAAAA,IAACG,EAAA,CACC,UAAW,CACT,KAAAlB,EACA,SAAUQ,CAAA,EAEZ,QAAAN,EACA,OAAQ,GACR,YAAaG,EAAU,KACvB,SAAUG,CAAA,CAAA,CACZ,CAAA,CACF,CAAA,EAtCAO,EAAAA,IAACC,EAAA,CACC,MAAM,kBACN,YAAAT,EAEA,SAAAQ,EAAAA,IAAC,OAAI,SAAA,iBAAA,CAAe,CAAA,CAAA,CAqC5B"}