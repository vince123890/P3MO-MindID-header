{"version":3,"file":"Form-BYf-rGXA.js","sources":["../../src/app/(protected)/master-data/template-messaging/_components/Form.jsx"],"sourcesContent":["import { Button, Col, Form, Input, Row, Select, Space, Typography, Tabs, Switch } from \"antd\";\nimport { Section } from \"admiral\";\nimport { Flex } from \"antd\";\nimport { useNavigate } from \"react-router\";\nimport { useState } from \"react\";\nimport { EyeOutlined, EditOutlined } from \"@ant-design/icons\";\n\nimport { useFormErrorHandling } from \"@/app/_hooks/form/use-form-error-handling\";\nimport { allPerusahaans } from \"../../perusahaans/_data\";\n\n// Category and Trigger options\nconst categoryOptions = [\n  {\n    label: \"Communication & Announcements\",\n    value: \"Communication & Announcements\",\n  },\n  {\n    label: \"Notifications & Reminders\",\n    value: \"Notifications & Reminders\",\n  },\n  {\n    label: \"System & Security Alerts\",\n    value: \"System & Security Alerts\",\n  },\n];\n\nconst triggerOptions = {\n  \"Communication & Announcements\": [\n    { label: \"Registration Completed\", value: \"Registration Completed\" },\n    { label: \"Event Created\", value: \"Event Created\" },\n  ],\n  \"Notifications & Reminders\": [\n    { label: \"Project Status\", value: \"Project Status\" },\n    { label: \"Meeting Scheduled (X hours before start)\", value: \"Meeting Scheduled (X hours before start)\" },\n    { label: \"Due Date Approaching\", value: \"Due Date Approaching\" },\n    { label: \"Significant Decline Curve\", value: \"Significant Decline Curve\" },\n  ],\n  \"System & Security Alerts\": [\n    { label: \"Scheduled System Maintenance\", value: \"Scheduled System Maintenance\" },\n    { label: \"Login from New Device\", value: \"Login from New Device\" },\n  ],\n};\n\nconst { TextArea } = Input;\n\nexport const FormTemplateMessaging = ({ formProps, error, loading, isEdit }) => {\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const [bodyContent, setBodyContent] = useState(\"\");\n  const [activePreviewTab, setActivePreviewTab] = useState(\"edit\");\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\n\n  useFormErrorHandling(error, ({ key, message }) =>\n    form.setFields([{ name: key, errors: [message] }]),\n  );\n\n  // Get perusahaan options from existing data\n  const perusahaanOptions = allPerusahaans.data.items.map((item) => ({\n    label: item.nama_perusahaan,\n    value: item.nama_perusahaan,\n  }));\n\n  // Handle category change\n  const handleCategoryChange = (value) => {\n    setSelectedCategory(value);\n    form.setFieldsValue({ trigger: undefined }); // Reset trigger when category changes\n  };\n\n  // Handle body content changes\n  const handleBodyChange = (e) => {\n    const value = e.target.value;\n    setBodyContent(value);\n    form.setFieldsValue({ body: value });\n  };\n\n  // Process placeholders for preview\n  const processPlaceholders = (content) => {\n    if (!content) return '<p style=\"color: #999;\">No content available</p>';\n    \n    const sampleData = {\n      '[Name]': 'John Doe',\n      '[Date]': new Date().toLocaleDateString(),\n      '[Project Name]': 'Sample Project',\n      '[Status]': 'Active',\n      '[Contact]': 'contact@example.com'\n    };\n\n    let processedContent = content;\n    Object.keys(sampleData).forEach(placeholder => {\n      const regex = new RegExp(placeholder.replace(/\\[|\\]/g, '\\\\$&'), 'g');\n      processedContent = processedContent.replace(regex, sampleData[placeholder]);\n    });\n\n    return processedContent;\n  };\n\n  const previewTabs = [\n    {\n      key: 'edit',\n      label: (\n        <span>\n          <EditOutlined />\n          Edit Content\n        </span>\n      ),\n      children: (\n        <TextArea\n          value={bodyContent}\n          onChange={handleBodyChange}\n          rows={12}\n          placeholder=\"Enter message body content (HTML supported)&#10;&#10;Available placeholders:&#10;- [Name] - Recipient name&#10;- [Date] - Current date&#10;- [Project Name] - Project name&#10;- [Status] - Status value&#10;- [Contact] - Contact information&#10;&#10;Example:&#10;&lt;h2&gt;Message Title&lt;/h2&gt;&#10;&lt;p&gt;Hello &lt;strong&gt;[Name]&lt;/strong&gt;,&lt;/p&gt;&#10;&lt;p&gt;Your message content here...&lt;/p&gt;\"\n          style={{ fontFamily: \"monospace\" }}\n        />\n      )\n    },\n    {\n      key: 'preview',\n      label: (\n        <span>\n          <EyeOutlined />\n          HTML Preview\n        </span>\n      ),\n      children: (\n        <div style={{ \n          border: '1px solid #d9d9d9', \n          borderRadius: '6px', \n          padding: '16px',\n          backgroundColor: '#fafafa',\n          minHeight: '300px'\n        }}>\n          <Typography.Text type=\"secondary\" style={{ fontSize: '12px', display: 'block', marginBottom: '8px' }}>\n            HTML Preview (with sample placeholder values):\n          </Typography.Text>\n          <div \n            style={{ \n              backgroundColor: 'white', \n              padding: '16px', \n              borderRadius: '4px',\n              border: '1px solid #e8e8e8',\n              minHeight: '150px'\n            }}\n            dangerouslySetInnerHTML={{ \n              __html: processPlaceholders(bodyContent)\n            }}\n          />\n          \n          <Typography.Text type=\"secondary\" style={{ fontSize: '12px', display: 'block', marginTop: '16px', marginBottom: '8px' }}>\n            Raw HTML Code:\n          </Typography.Text>\n          <div style={{ \n            backgroundColor: '#f5f5f5', \n            padding: '12px', \n            borderRadius: '4px',\n            fontFamily: 'monospace',\n            fontSize: '12px',\n            whiteSpace: 'pre-wrap',\n            wordBreak: 'break-all',\n            maxHeight: '150px',\n            overflow: 'auto',\n            border: '1px solid #e8e8e8'\n          }}>\n            {bodyContent || 'No content available'}\n          </div>\n        </div>\n      )\n    }\n  ];\n\n  return (\n    <Form {...formProps} form={form} layout=\"vertical\">\n      <Section>\n        <Space direction=\"vertical\" size=\"middle\" style={{ width: \"100%\" }}>\n          <Section title=\"Template Information\">\n            <Row gutter={16}>\n              <Col span={12}>\n                <Form.Item\n                  label=\"Nama Template\"\n                  name=\"nama_template\"\n                  rules={[\n                    {\n                      required: true,\n                      message: \"Nama Template is required\",\n                    },\n                    {\n                      min: 1,\n                      message: \"Nama Template must be at least 1 character\",\n                    },\n                  ]}\n                >\n                  <Input placeholder=\"Enter template name\" />\n                </Form.Item>\n              </Col>\n              <Col span={12}>\n                <Form.Item\n                  label=\"Category\"\n                  name=\"category\"\n                  rules={[\n                    {\n                      required: true,\n                      message: \"Category is required\",\n                    },\n                  ]}\n                >\n                  <Select \n                    placeholder=\"Select category\" \n                    onChange={handleCategoryChange}\n                    options={categoryOptions}\n                  />\n                </Form.Item>\n              </Col>\n              <Col span={12}>\n                <Form.Item\n                  label=\"Trigger\"\n                  name=\"trigger\"\n                  rules={[\n                    {\n                      required: true,\n                      message: \"Trigger is required\",\n                    },\n                  ]}\n                >\n                  <Select \n                    placeholder=\"Select trigger\" \n                    disabled={!selectedCategory}\n                    options={selectedCategory ? triggerOptions[selectedCategory] : []}\n                  />\n                </Form.Item>\n              </Col>\n              <Col span={12}>\n                <Form.Item\n                  label=\"Status\"\n                  name=\"status\"\n                  valuePropName=\"checked\"\n                  getValueFromEvent={(checked) => checked ? \"Active\" : \"Inactive\"}\n                  getValueProps={(value) => ({ checked: value === \"Active\" })}\n                >\n                  <Switch \n                    checkedChildren=\"Active\" \n                    unCheckedChildren=\"Inactive\"\n                    defaultChecked={true}\n                  />\n                </Form.Item>\n              </Col>\n            </Row>\n          </Section>\n\n          <Section title=\"Message Content\">\n            <Row gutter={16}>\n              <Col span={24}>\n                <Form.Item\n                  label=\"Body\"\n                  name=\"body\"\n                  rules={[\n                    {\n                      required: true,\n                      message: \"Body is required\",\n                    },\n                    {\n                      min: 10,\n                      message: \"Body must be at least 10 characters\",\n                    },\n                  ]}\n                >\n                  <Tabs\n                    activeKey={activePreviewTab}\n                    onChange={setActivePreviewTab}\n                    items={previewTabs}\n                    size=\"small\"\n                  />\n                </Form.Item>\n                <div style={{ marginTop: 8, fontSize: \"12px\", color: \"#666\" }}>\n                  <strong>Note:</strong> This field supports HTML formatting. Use placeholders like [Name], [Date], [Project Name] for dynamic content.\n                  <br />\n                  <strong>Preview:</strong> Switch to the \"HTML Preview\" tab to see how your content will look when rendered.\n                  <br />\n                  <strong>Future Enhancement:</strong> This will be replaced with a TinyMCE WYSIWYG editor for better content editing experience.\n                </div>\n              </Col>\n            </Row>\n          </Section>\n        </Space>\n      </Section>\n\n      <Flex justify=\"flex-end\" gap={16} style={{ marginTop: 24 }}>\n        <Button type=\"text\" disabled={loading} onClick={() => navigate(\"/master-data/template-messaging\")}>\n          Cancel\n        </Button>\n        <Button type=\"primary\" htmlType=\"submit\" loading={loading}>\n          {isEdit ? \"Save Changes\" : \"Submit\"}\n        </Button>\n      </Flex>\n    </Form>\n  );\n};\n"],"names":["categoryOptions","triggerOptions","TextArea","Input","FormTemplateMessaging","formProps","error","loading","isEdit","form","Form","navigate","useNavigate","bodyContent","setBodyContent","useState","activePreviewTab","setActivePreviewTab","selectedCategory","setSelectedCategory","useFormErrorHandling","key","message","allPerusahaans","item","handleCategoryChange","value","handleBodyChange","e","processPlaceholders","content","sampleData","processedContent","placeholder","regex","previewTabs","jsx","EditOutlined","EyeOutlined","jsxs","Typography","Section","Space","Row","Col","Select","checked","Switch","Tabs","Flex","Button"],"mappings":"m8BAWA,MAAMA,EAAkB,CACtB,CACE,MAAO,gCACP,MAAO,+BAAA,EAET,CACE,MAAO,4BACP,MAAO,2BAAA,EAET,CACE,MAAO,2BACP,MAAO,0BAAA,CAEX,EAEMC,EAAiB,CACrB,gCAAiC,CAC/B,CAAE,MAAO,yBAA0B,MAAO,wBAAA,EAC1C,CAAE,MAAO,gBAAiB,MAAO,eAAA,CAAgB,EAEnD,4BAA6B,CAC3B,CAAE,MAAO,iBAAkB,MAAO,gBAAA,EAClC,CAAE,MAAO,2CAA4C,MAAO,0CAAA,EAC5D,CAAE,MAAO,uBAAwB,MAAO,sBAAA,EACxC,CAAE,MAAO,4BAA6B,MAAO,2BAAA,CAA4B,EAE3E,2BAA4B,CAC1B,CAAE,MAAO,+BAAgC,MAAO,8BAAA,EAChD,CAAE,MAAO,wBAAyB,MAAO,uBAAA,CAAwB,CAErE,EAEM,CAAE,SAAAC,GAAaC,EAERC,GAAwB,CAAC,CAAE,UAAAC,EAAW,MAAAC,EAAO,QAAAC,EAAS,OAAAC,KAAa,CAC9E,KAAM,CAACC,CAAI,EAAIC,EAAK,QAAA,EACdC,EAAWC,EAAA,EACX,CAACC,EAAaC,CAAc,EAAIC,EAAAA,SAAS,EAAE,EAC3C,CAACC,EAAkBC,CAAmB,EAAIF,EAAAA,SAAS,MAAM,EACzD,CAACG,EAAkBC,CAAmB,EAAIJ,EAAAA,SAAS,EAAE,EAE3DK,EAAqBd,EAAO,CAAC,CAAE,IAAAe,EAAK,QAAAC,CAAA,IAClCb,EAAK,UAAU,CAAC,CAAE,KAAMY,EAAK,OAAQ,CAACC,CAAO,CAAA,CAAG,CAAC,CAAA,EAIzBC,EAAe,KAAK,MAAM,IAAKC,IAAU,CACjE,MAAOA,EAAK,gBACZ,MAAOA,EAAK,eAAA,EACZ,EAGF,MAAMC,EAAwBC,GAAU,CACtCP,EAAoBO,CAAK,EACzBjB,EAAK,eAAe,CAAE,QAAS,MAAA,CAAW,CAC5C,EAGMkB,EAAoBC,GAAM,CAC9B,MAAMF,EAAQE,EAAE,OAAO,MACvBd,EAAeY,CAAK,EACpBjB,EAAK,eAAe,CAAE,KAAMiB,CAAA,CAAO,CACrC,EAGMG,EAAuBC,GAAY,CACvC,GAAI,CAACA,EAAS,MAAO,mDAErB,MAAMC,EAAa,CACjB,SAAU,WACV,SAAU,IAAI,KAAA,EAAO,mBAAA,EACrB,iBAAkB,iBAClB,WAAY,SACZ,YAAa,qBAAA,EAGf,IAAIC,EAAmBF,EACvB,cAAO,KAAKC,CAAU,EAAE,QAAQE,GAAe,CAC7C,MAAMC,EAAQ,IAAI,OAAOD,EAAY,QAAQ,SAAU,MAAM,EAAG,GAAG,EACnED,EAAmBA,EAAiB,QAAQE,EAAOH,EAAWE,CAAW,CAAC,CAC5E,CAAC,EAEMD,CACT,EAEMG,EAAc,CAClB,CACE,IAAK,OACL,aACG,OAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,EAAA,EAAa,EAAE,cAAA,EAElB,EAEF,SACED,EAAAA,IAAClC,EAAA,CACC,MAAOW,EACP,SAAUc,EACV,KAAM,GACN,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qCACZ,MAAO,CAAE,WAAY,WAAA,CAAY,CAAA,CACnC,EAGJ,CACE,IAAK,UACL,aACG,OAAA,CACC,SAAA,CAAAS,EAAAA,IAACE,EAAA,EAAY,EAAE,cAAA,EAEjB,EAEF,SACEC,EAAAA,KAAC,MAAA,CAAI,MAAO,CACV,OAAQ,oBACR,aAAc,MACd,QAAS,OACT,gBAAiB,UACjB,UAAW,OAAA,EAEX,SAAA,CAAAH,EAAAA,IAACI,EAAW,KAAX,CAAgB,KAAK,YAAY,MAAO,CAAE,SAAU,OAAQ,QAAS,QAAS,aAAc,KAAA,EAAS,SAAA,iDAEtG,EACAJ,EAAAA,IAAC,MAAA,CACC,MAAO,CACL,gBAAiB,QACjB,QAAS,OACT,aAAc,MACd,OAAQ,oBACR,UAAW,OAAA,EAEb,wBAAyB,CACvB,OAAQP,EAAoBhB,CAAW,CAAA,CACzC,CAAA,QAGD2B,EAAW,KAAX,CAAgB,KAAK,YAAY,MAAO,CAAE,SAAU,OAAQ,QAAS,QAAS,UAAW,OAAQ,aAAc,OAAS,SAAA,iBAEzH,EACAJ,MAAC,OAAI,MAAO,CACV,gBAAiB,UACjB,QAAS,OACT,aAAc,MACd,WAAY,YACZ,SAAU,OACV,WAAY,WACZ,UAAW,YACX,UAAW,QACX,SAAU,OACV,OAAQ,mBAAA,EAEP,YAAe,sBAAA,CAClB,CAAA,CAAA,CACF,CAAA,CAEJ,EAGF,cACG1B,EAAA,CAAM,GAAGL,EAAW,KAAAI,EAAY,OAAO,WACtC,SAAA,CAAA2B,EAAAA,IAACK,EAAA,CACC,SAAAF,EAAAA,KAACG,EAAA,CAAM,UAAU,WAAW,KAAK,SAAS,MAAO,CAAE,MAAO,MAAA,EACxD,SAAA,CAAAN,EAAAA,IAACK,GAAQ,MAAM,uBACb,SAAAF,EAAAA,KAACI,EAAA,CAAI,OAAQ,GACX,SAAA,CAAAP,EAAAA,IAACQ,EAAA,CAAI,KAAM,GACT,SAAAR,EAAAA,IAAC1B,EAAK,KAAL,CACC,MAAM,gBACN,KAAK,gBACL,MAAO,CACL,CACE,SAAU,GACV,QAAS,2BAAA,EAEX,CACE,IAAK,EACL,QAAS,4CAAA,CACX,EAGF,SAAA0B,EAAAA,IAACjC,EAAA,CAAM,YAAY,qBAAA,CAAsB,CAAA,CAAA,EAE7C,EACAiC,EAAAA,IAACQ,EAAA,CAAI,KAAM,GACT,SAAAR,EAAAA,IAAC1B,EAAK,KAAL,CACC,MAAM,WACN,KAAK,WACL,MAAO,CACL,CACE,SAAU,GACV,QAAS,sBAAA,CACX,EAGF,SAAA0B,EAAAA,IAACS,EAAA,CACC,YAAY,kBACZ,SAAUpB,EACV,QAASzB,CAAA,CAAA,CACX,CAAA,EAEJ,EACAoC,EAAAA,IAACQ,EAAA,CAAI,KAAM,GACT,SAAAR,EAAAA,IAAC1B,EAAK,KAAL,CACC,MAAM,UACN,KAAK,UACL,MAAO,CACL,CACE,SAAU,GACV,QAAS,qBAAA,CACX,EAGF,SAAA0B,EAAAA,IAACS,EAAA,CACC,YAAY,iBACZ,SAAU,CAAC3B,EACX,QAASA,EAAmBjB,EAAeiB,CAAgB,EAAI,CAAA,CAAC,CAAA,CAClE,CAAA,EAEJ,EACAkB,EAAAA,IAACQ,EAAA,CAAI,KAAM,GACT,SAAAR,EAAAA,IAAC1B,EAAK,KAAL,CACC,MAAM,SACN,KAAK,SACL,cAAc,UACd,kBAAoBoC,GAAYA,EAAU,SAAW,WACrD,cAAgBpB,IAAW,CAAE,QAASA,IAAU,QAAA,GAEhD,SAAAU,EAAAA,IAACW,EAAA,CACC,gBAAgB,SAChB,kBAAkB,WAClB,eAAgB,EAAA,CAAA,CAClB,CAAA,CACF,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAEAX,EAAAA,IAACK,EAAA,CAAQ,MAAM,kBACb,SAAAL,EAAAA,IAACO,EAAA,CAAI,OAAQ,GACX,SAAAJ,OAACK,EAAA,CAAI,KAAM,GACT,SAAA,CAAAR,EAAAA,IAAC1B,EAAK,KAAL,CACC,MAAM,OACN,KAAK,OACL,MAAO,CACL,CACE,SAAU,GACV,QAAS,kBAAA,EAEX,CACE,IAAK,GACL,QAAS,qCAAA,CACX,EAGF,SAAA0B,EAAAA,IAACY,EAAA,CACC,UAAWhC,EACX,SAAUC,EACV,MAAOkB,EACP,KAAK,OAAA,CAAA,CACP,CAAA,EAEFI,EAAAA,KAAC,MAAA,CAAI,MAAO,CAAE,UAAW,EAAG,SAAU,OAAQ,MAAO,MAAA,EACnD,SAAA,CAAAH,EAAAA,IAAC,UAAO,SAAA,OAAA,CAAK,EAAS,wHACrB,KAAA,EAAG,EACJA,EAAAA,IAAC,UAAO,SAAA,UAAA,CAAQ,EAAS,2FACxB,KAAA,EAAG,EACJA,EAAAA,IAAC,UAAO,SAAA,qBAAA,CAAmB,EAAS,6FAAA,CAAA,CACtC,CAAA,CAAA,CACF,EACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAEAG,EAAAA,KAACU,EAAA,CAAK,QAAQ,WAAW,IAAK,GAAI,MAAO,CAAE,UAAW,EAAA,EACpD,SAAA,CAAAb,EAAAA,IAACc,EAAA,CAAO,KAAK,OAAO,SAAU3C,EAAS,QAAS,IAAMI,EAAS,iCAAiC,EAAG,SAAA,QAAA,CAEnG,EACAyB,EAAAA,IAACc,GAAO,KAAK,UAAU,SAAS,SAAS,QAAA3C,EACtC,SAAAC,EAAS,eAAiB,QAAA,CAC7B,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}